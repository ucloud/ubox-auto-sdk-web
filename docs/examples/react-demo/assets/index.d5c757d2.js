var w=Object.defineProperty,B=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var g=(o,t,n)=>t in o?w(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,x=(o,t)=>{for(var n in t||(t={}))O.call(t,n)&&g(o,n,t[n]);if(b)for(var n of b(t))P.call(t,n)&&g(o,n,t[n]);return o},C=(o,t)=>B(o,M(t));import{R as I,r as l,j as r,M as S,L as v,C as K,a as m,B as j,b as d,c as y,d as k,e as E,F as A,S as F,f as p,I as h,g as R}from"./vendor.29d92bc4.js";const $=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(e){if(e.ep)return;e.ep=!0;const s=n(e);fetch(e.href,s)}};$();const _=I.createContext(),f=I.createContext(),J=({open:o,box:t})=>d(y,{container:!0,justifyContent:"space-between",alignItems:"center",className:"box-title",children:[d(k,{children:[t.ID,r(E,{dot:!0,color:t.SdnboxState===1?"primary":"red"})]}),r("div",{style:{float:"right"},children:o?"\u6536\u8D77":"\u5C55\u5F00"})]}),U=({camera:o,sdnboxId:t})=>{const n=l.exports.useContext(f),a=l.exports.useRef(null);return l.exports.useEffect(()=>{if(!a.current)return;const e=n.play(a.current,{url:"webrtc://106.75.32.7/live/yushi_dev_video2"});return console.log(e),e.start(),e.stats().then(console.log),()=>{e.stop()}},[]),r(y,{container:!0,alignItems:"center",justifyContent:"center",padding:"lg",children:r("video",{ref:a,width:"480",height:"320"})})},V=({camera:o,sdnboxId:t,onClose:n})=>r(m,{visible:!0,onClose:n,children:r(U,{camera:o,sdnboxId:t})}),T=({camera:o,sdnboxId:t})=>{const n=l.exports.useContext(f),[a,e]=l.exports.useState(!1),{onUpdate:s}=l.exports.useContext(_),[i,c]=l.exports.useState(!1),u=l.exports.useCallback(async N=>{e(!0);try{N?await n.startSdnboxCameraPushing({sdnboxId:t,cameraId:o.ID}):await n.stopSdnboxCameraPushing({sdnboxId:t,cameraId:o.ID}),s()}catch(q){S.error(q+"")}finally{e(!1)}},[]),L=l.exports.useCallback(()=>{c(!1)},[]),D=l.exports.useCallback(()=>{c(!0)},[]);return d(A,{children:[r(v,{loading:a,children:d(y,{container:!0,justifyContent:"space-between",alignItems:"center",className:"camera",children:[r("div",{children:o.ID}),d(k,{children:[r(j,{onClick:D,children:"\u64AD\u653E"}),r(F,{checked:o.Status===1,onChange:u})]})]})}),i&&r(V,{onClose:L,camera:o,sdnboxId:t})]})},H=()=>{const o=l.exports.useContext(f),[t,n]=l.exports.useState(!1),[a,e]=l.exports.useState([]),s=l.exports.useCallback(async()=>{n(!0);try{const c=await o.getSdnboxCameraList();e(c)}catch(c){S.error(c+"")}finally{n(!1)}},[]);l.exports.useEffect(()=>{s()},[]);const i=l.exports.useCallback(()=>{s()},[]);return r(_.Provider,{value:{onUpdate:i},children:r(v,{loading:t,style:{minHeight:"300px"},children:r(K,{multiple:!1,children:r("div",{className:"box-list",children:a.map(c=>r(K.Panel,{panelKey:c.ID,className:"box-item",title:u=>r(J,C(x({},u),{box:c})),children:r("div",{children:c.Camera.map(u=>r(T,{sdnboxId:c.ID,camera:u},u.ID))})},c.ID))})})})})},z=({onSubmit:o})=>{l.exports.useEffect(()=>{const n=localStorage.getItem("lastInput"),a=(e,s)=>document.querySelector(`#${e}`).value=s;if(n){const{publicKey:e,privateKey:s,projectId:i}=JSON.parse(n);a("publicKey",e),a("privateKey",s),a("projectId",i)}},[]);const t=l.exports.useCallback(n=>{const a=s=>document.querySelector(`#${s}`).value,e={publicKey:a("publicKey"),privateKey:a("privateKey"),projectId:a("projectId")};localStorage.setItem("lastInput",JSON.stringify(e)),o(e)},[]);return d(p,{id:"form",onSubmit:t,children:[r(p.Item,{label:"publicKey",children:r(h,{required:!0,block:!0,id:"publicKey"})}),r(p.Item,{label:"privateKey",children:r(h,{required:!0,block:!0,id:"privateKey"})}),r(p.Item,{label:"projectId",children:r(h,{required:!0,block:!0,id:"projectId"})})]})},G=({onSubmit:o})=>{const t=l.exports.useCallback(()=>{document.querySelector("#form").requestSubmit()},[]),n=l.exports.useCallback(a=>{const e=i=>document.querySelector(`#${i}`).value,s={publicKey:e("publicKey"),privateKey:e("privateKey"),projectId:e("projectId")};localStorage.setItem("lastInput",JSON.stringify(s)),o(s)},[]);return r(m,{visible:!0,footer:r(j,{styleType:"primary",onClick:t,children:"\u786E\u5B9A"}),closable:!1,children:r(m.Content,{children:r(z,{onSubmit:n})})})};function Q(){const[o,t]=l.exports.useState(!0),[n,a]=l.exports.useState(null),e=l.exports.useCallback(s=>{a(UBoxAuto(s)),t(!1)},[]);return o?r(G,{onSubmit:e}):r(f.Provider,{value:n,children:r(H,{})})}R.render(r(Q,{}),document.getElementById("root"));
