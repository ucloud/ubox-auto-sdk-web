var N=Object.defineProperty,q=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var D=(n,r,o)=>r in n?N(n,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[r]=o,B=(n,r)=>{for(var o in r||(r={}))O.call(r,o)&&D(n,o,r[o]);if(j)for(var o of j(r))R.call(r,o)&&D(n,o,r[o]);return n},L=(n,r)=>q(n,M(r));import{R as E,r as l,j as t,M as S,L as P,C as _,a as m,B as h,b as p,c as v,d as K,e as A,F,S as U,f as x,I as C,g as $}from"./vendor.29d92bc4.js";const J=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function o(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(e){if(e.ep)return;e.ep=!0;const s=o(e);fetch(e.href,s)}};J();const w=E.createContext(),g=E.createContext(),T=({open:n,box:r})=>p(v,{container:!0,justifyContent:"space-between",alignItems:"center",className:"box-title",children:[p(K,{children:[r.ID,t(A,{dot:!0,color:r.SdnboxState===1?"primary":"red"})]}),t("div",{style:{float:"right"},children:n?"\u6536\u8D77":"\u5C55\u5F00"})]}),V=({camera:n,sdnboxId:r})=>{const o=l.exports.useContext(g),a=l.exports.useRef(null),[e,s]=l.exports.useState(null),[i,c]=l.exports.useState(0),u=l.exports.useRef(null),[f,b]=l.exports.useState(()=>({cameraId:n.ID,sdnboxId:r}));l.exports.useEffect(()=>{if(!!a.current){try{u.current=o.play(a.current,f,{onError:d=>{s(d),c(y=>y+1)},onRestore:()=>{s(null),c(0)}}),u.current.start()}catch(d){S.error(d+""),console.error(d)}return()=>{var d,y;(d=u.current)==null||d.stop(),(y=u.current)==null||y.destroy(),u.current=null}}},[f]);const I=l.exports.useCallback(()=>{var d;(d=u.current)==null||d.stats().then(y=>{console.log(y),y.forEach(console.log)})},[]);return p(v,{container:!0,direction:"column",alignItems:"center",justifyContent:"center",spacing:"lg",children:[t("div",{ref:a,style:{width:"600px",height:"400px",boxShadow:e?"red 0px 0px 5px 1px":"green 0px 0px 5px 1px"}}),p(K,{children:[t(h,{onClick:I,children:"Stats"}),t(C,{id:"urlInput",style:{width:"200px"}}),t(h,{onClick:()=>{const d=document.getElementById("urlInput").value;b({url:d})},styleType:"primary",children:"Play URL"})]}),e&&p("p",{children:[e+"",", \u91CD\u8BD5\u7B2C ",i," \u6B21"]})]})},H=({camera:n,sdnboxId:r,onClose:o})=>t(m,{visible:!0,onClose:o,children:t(m.Content,{children:t(V,{camera:n,sdnboxId:r})})}),z=({camera:n,sdnboxId:r})=>{const o=l.exports.useContext(g),[a,e]=l.exports.useState(!1),{onUpdate:s}=l.exports.useContext(w),[i,c]=l.exports.useState(!1),u=l.exports.useCallback(async I=>{e(!0);try{I?await o.startSdnboxCameraPushing({sdnboxId:r,cameraId:n.ID}):await o.stopSdnboxCameraPushing({sdnboxId:r,cameraId:n.ID}),s()}catch(k){S.error(k+"")}finally{e(!1)}},[]),f=l.exports.useCallback(()=>{c(!1)},[]),b=l.exports.useCallback(()=>{c(!0)},[]);return p(F,{children:[t(P,{loading:a,children:p(v,{container:!0,justifyContent:"space-between",alignItems:"center",className:"camera",children:[t("div",{children:n.ID}),p(K,{children:[t(h,{onClick:b,children:"\u64AD\u653E"}),t(U,{checked:n.Status===1,onChange:u})]})]})}),i&&t(H,{onClose:f,camera:n,sdnboxId:r})]})},G=()=>{const n=l.exports.useContext(g),[r,o]=l.exports.useState(!1),[a,e]=l.exports.useState([]),s=l.exports.useCallback(async()=>{o(!0);try{const c=await n.getSdnboxCameraList();e(c)}catch(c){S.error(c+"")}finally{o(!1)}},[]);l.exports.useEffect(()=>{s()},[]);const i=l.exports.useCallback(()=>{s()},[]);return t(w.Provider,{value:{onUpdate:i},children:t(P,{loading:r,style:{minHeight:"300px"},children:t(_,{multiple:!1,children:t("div",{className:"box-list",children:a.map(c=>t(_.Panel,{panelKey:c.ID,className:"box-item",title:u=>t(T,L(B({},u),{box:c})),children:t("div",{children:c.Camera.map(u=>t(z,{sdnboxId:c.ID,camera:u},u.ID))})},c.ID))})})})})},Q=({onSubmit:n})=>{l.exports.useEffect(()=>{const o=localStorage.getItem("lastInput"),a=(e,s)=>document.querySelector(`#${e}`).value=s;if(o){const{publicKey:e,privateKey:s,projectId:i}=JSON.parse(o);a("publicKey",e),a("privateKey",s),a("projectId",i)}},[]);const r=l.exports.useCallback(o=>{const a=s=>document.querySelector(`#${s}`).value,e={publicKey:a("publicKey"),privateKey:a("privateKey"),projectId:a("projectId")};localStorage.setItem("lastInput",JSON.stringify(e)),n(e)},[]);return p(x,{id:"form",onSubmit:r,children:[t(x.Item,{label:"publicKey",children:t(C,{required:!0,block:!0,id:"publicKey"})}),t(x.Item,{label:"privateKey",children:t(C,{required:!0,block:!0,id:"privateKey"})}),t(x.Item,{label:"projectId",children:t(C,{required:!0,block:!0,id:"projectId"})})]})},W=({onSubmit:n})=>{const r=l.exports.useCallback(()=>{document.querySelector("#form").requestSubmit()},[]),o=l.exports.useCallback(a=>{const e=i=>document.querySelector(`#${i}`).value,s={publicKey:e("publicKey"),privateKey:e("privateKey"),projectId:e("projectId")};localStorage.setItem("lastInput",JSON.stringify(s)),n(s)},[]);return t(m,{visible:!0,footer:t(h,{styleType:"primary",onClick:r,children:"\u786E\u5B9A"}),closable:!1,children:t(m.Content,{children:t(Q,{onSubmit:o})})})};function X(){const[n,r]=l.exports.useState(!0),[o,a]=l.exports.useState(null),e=l.exports.useCallback(s=>{a(UBoxAuto(s,{debug:!0})),r(!1)},[]);return n?t(W,{onSubmit:e}):t(g.Provider,{value:o,children:t(G,{})})}$.render(t(X,{}),document.getElementById("root"));
